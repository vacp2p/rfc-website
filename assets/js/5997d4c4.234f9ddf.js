"use strict";(self.webpackChunklogos_docs_template=self.webpackChunklogos_docs_template||[]).push([[8450],{41163:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const i={title:"15/WAKU-BRIDGE",name:"Waku Bridge",status:"draft",editor:"Hanno Cornelius <hanno@status.im>"},o=void 0,l={unversionedId:"standards/core/15/bridge",id:"standards/core/15/bridge",title:"15/WAKU-BRIDGE",description:"- Status: draft",source:"@site/waku/standards/core/15/bridge.md",sourceDirName:"standards/core/15",slug:"/standards/core/15/bridge",permalink:"/waku/standards/core/15/bridge",draft:!1,tags:[],version:"current",frontMatter:{title:"15/WAKU-BRIDGE",name:"Waku Bridge",status:"draft",editor:"Hanno Cornelius \\<hanno@status.im\\>"},sidebar:"defaultSidebar",previous:{title:"14/WAKU2-MESSAGE",permalink:"/waku/standards/core/14/message"},next:{title:"17/WAKU2-RLN-RELAY",permalink:"/waku/standards/core/17/rln-relay"}},s={},p=[{value:"Bridge",id:"bridge",level:2},{value:"Security Considerations",id:"security-considerations",level:3},{value:"Copyright",id:"copyright",level:2}],u={toc:p};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Status: draft"),(0,a.kt)("li",{parentName:"ul"},"Editor: Hanno Cornelius \\",(0,a.kt)("a",{parentName:"li",href:"mailto:hanno@status.im%5C"},"hanno@status.im\\"))),(0,a.kt)("p",null,"A bridge between Waku v1 and Waku v2."),(0,a.kt)("h2",{id:"bridge"},"Bridge"),(0,a.kt)("p",null,"A bridge requires supporting both Waku versions:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Waku v1 - using devp2p RLPx protocol"),(0,a.kt)("li",{parentName:"ul"},"Waku v2 - using libp2p protocols")),(0,a.kt)("p",null,"Packets received on the Waku v1 network SHOULD be published just once on the\nWaku v2 network. More specifically, the bridge SHOULD publish\nthis through the Waku Relay (PubSub domain)."),(0,a.kt)("p",null,"Publishing such packet will require the creation of a new ",(0,a.kt)("inlineCode",{parentName:"p"},"Message")," with a\nnew ",(0,a.kt)("inlineCode",{parentName:"p"},"WakuMessage")," as data field. The ",(0,a.kt)("inlineCode",{parentName:"p"},"data")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"topic")," field from the Waku v1\n",(0,a.kt)("inlineCode",{parentName:"p"},"Envelope")," MUST be copied to the ",(0,a.kt)("inlineCode",{parentName:"p"},"payload")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"contentTopic")," fields of the\n",(0,a.kt)("inlineCode",{parentName:"p"},"WakuMessage"),". Other fields such as nonce, expiry and ttl will be dropped as\nthey become obsolete in Waku v2."),(0,a.kt)("p",null,"Before this is done, the usual envelope verification still applies:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Expiry & future time verification"),(0,a.kt)("li",{parentName:"ul"},"PoW verification"),(0,a.kt)("li",{parentName:"ul"},"Size verification")),(0,a.kt)("p",null,"Bridging SHOULD occur through the ",(0,a.kt)("inlineCode",{parentName:"p"},"WakuRelay"),", but it MAY also be done on other Waku\nv2 protocols (e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"WakuFilter"),"). The latter is however not advised as it will\nincrease the complexity of the bridge and because of the\n",(0,a.kt)("a",{parentName:"p",href:"#security-considerations"},"Security Considerations")," explained further below."),(0,a.kt)("p",null,"Packets received on the Waku v2 network SHOULD be posted just once on the Waku\nv1 network. The Waku v2 ",(0,a.kt)("inlineCode",{parentName:"p"},"WakuMessage")," contains only the ",(0,a.kt)("inlineCode",{parentName:"p"},"payload")," and\n",(0,a.kt)("inlineCode",{parentName:"p"},"contentTopic")," fields. The bridge MUST create a new Waku v1 ",(0,a.kt)("inlineCode",{parentName:"p"},"Envelope")," and\ncopy over the ",(0,a.kt)("inlineCode",{parentName:"p"},"payload")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"contentFilter")," fields to the ",(0,a.kt)("inlineCode",{parentName:"p"},"data")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"topic"),"\nfields. Next, before posting on the network, the bridge MUST set a new expiry\nand ttl and do the PoW nonce calculation."),(0,a.kt)("h3",{id:"security-considerations"},"Security Considerations"),(0,a.kt)("p",null,"As mentioned above, a bridge will be posting new Waku v1 envelopes, which\nrequires doing the PoW nonce calculation."),(0,a.kt)("p",null,"This could be a DoS attack vector, as the PoW calculation will make it more\nexpensive to post the message compared to the original publishing on the Waku v2\nnetwork. Low PoW setting will lower this problem, but it is likely that it is\nstill more expensive."),(0,a.kt)("p",null,"For this reason, bridges SHOULD probably be run independently of other nodes, so\nthat a bridge that gets overwhelmed does not disrupt regular Waku v2 to v2\ntraffic."),(0,a.kt)("p",null,"Bridging functionality SHOULD also be carefully implemented so that messages do\nnot bounce back and forth between the two networks. The bridge SHOULD properly\ntrack messages with a seen filter so that no amplification can be achieved here."),(0,a.kt)("h2",{id:"copyright"},"Copyright"),(0,a.kt)("p",null,"Copyright and related rights waived via\n",(0,a.kt)("a",{parentName:"p",href:"https://creativecommons.org/publicdomain/zero/1.0/"},"CC0"),"."))}d.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),k=a,h=c["".concat(s,".").concat(k)]||c[k]||d[k]||i;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"}}]);